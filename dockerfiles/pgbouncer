FROM alpine:3.19

# Install PgBouncer
RUN apk add --no-cache pgbouncer

# Create config directory
RUN mkdir -p /etc/pgbouncer

# Copy entrypoint script
COPY dockerfiles/pgbouncer_entrypoint.sh /usr/local/bin/entrypoint.sh
RUN chmod +x /usr/local/bin/entrypoint.sh

# Copy configuration
COPY pgbouncer.ini /etc/pgbouncer/pgbouncer.ini

# Expose PgBouncer port
EXPOSE 6432

# Use entrypoint script
ENTRYPOINT ["/usr/local/bin/entrypoint.sh"]

